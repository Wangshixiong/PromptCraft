# 1. 核心理念 (Core Philosophy)

1.  **本地优先，可选同步**: 应用的核心体验必须保证在**未登录/离线状态**下功能的完整性。网络同步是用户**可选择**的增强功能，而非必要条件。
2.  **体验为王**: 始终追求极致的性能和用户体验。这包括“秒开”的响应速度、流畅的交互动画和简洁直观的界面设计。
3.  **安全透明**: 必须明确告知用户哪些数据将被同步。始终为用户提供可完全在本地使用的纯净模式。
4.  **最小化修改**: 对于代码的修改，必须遵循最小化修改原则。例如，新增功能必须经过认真思考，确保不会引入新的安全漏洞或性能问题。

# 2. 技术红线 (Technical Red Lines)

1.  **技术栈选型**:
    * **允许**: 坚持使用**原生JavaScript (ES6+)、CSS3、HTML5**作为核心。允许且推荐使用官方提供的、用于连接特定后端服务（如Supabase）的**专用JS SDK**。
    * **严禁**: **严禁**引入任何改变DOM结构和开发范式的前端框架（如React, Vue, Angular）或通用的工具/UI库（如jQuery, Lodash, Bootstrap）。

2.  **扩展标准**: 必须遵循最新的 **Chrome Extension Manifest V3** 标准，以确保安全性、性能和长期兼容性。
3.  **统一数据入口**: 所有对存储（无论是本地`chrome.storage`还是远程数据库）的读写操作，都**必须**通过统一的数据服务模块 (`src/utils/data-service.js`) 进行，严禁在其他地方直接调用存储API。

# 3. 开发规范 (Development Standards)

1.  **数据结构**: 所有“提示词”数据对象必须严格遵循以下核心结构，确保数据的一致性。
    ```json
    {
      "id": "string (UUID)",
      "title": "string",
      "content": "string",
      "category": "string",
      "created_at": "string (ISO 8601)",
      "updated_at": "string (ISO 8601)"
    }
    ```
2.  **代码质量**:
    * **注释**: 所有新增函数必须有JSDoc风格的注释（说明功能、参数、返回值）。复杂的业务逻辑必须添加行内注释。
    * **异步**: 全项目统一使用 `async/await` 进行异步编程。

3.  **UI一致性**: 所有新增的UI组件必须：
    * 使用CSS Variables，同时适配**明亮**和**暗黑**两种主题。
    * 保持与项目现有UI（如卡片、按钮、间距）的设计风格一致。

# 4. 网络与安全 (Networking & Security)

1.  **功能定位**: 网络功能**仅用于**经用户授权的账户登录与数据同步，不得用于其他目的（如追踪、广告）。
2.  **逻辑隔离**: 所有网络请求、用户认证、数据同步的逻辑**必须**封装在独立的专用模块中，不得与核心的本地操作逻辑（如UI渲染、本地数据管理）随意耦合。
3.  **离线可用**: 必须确保在网络连接失败或用户未登录时，应用的本地功能**完全可用**。
4.  **冲突解决**: 在开发同步功能时，必须设计并实现一套清晰的本地与云端数据**合并与冲突解决**策略，以防止用户数据意外丢失。

# 5. 任务执行框架 (Task Execution Framework)
1.  **任务分解与规划 (Plan)**:
    在接收到一个任务后，不能立即动手。必须先将该任务拆解为一份详细、有序的 `TODO` 清单文件，在docs目录下新建`TODO.md`。

2.  **方案确认 (Review)**:
    在动手前，你必须将完整的 `TODO` 清单展示给我。**这是执行前唯一需要我批准的停顿点**。

3.  **自主连续执行 (Autonomous Execution)**:
    一旦计划被我批准，你将开始自主、连续地执行`TODO`清单中的**所有**任务，**无需在每一步完成后停下**。你可以在执行过程中自行播报关键进度。

4.  **完成汇报与请求验收 (Final Report & Request for Review)**:
    当`TODO`清单中的**所有任务都完成后**，你必须：
    * a. 提供一份包含**所有工作内容**的完整总结报告。
    * b. **附上所有项都已标记为`[x]`的最终`TODO`清单**。
    * c. 明确表示本轮`TODO`任务已全部完成，并**请求我进行整体测试、代码审查或提供最终反馈**。

---
## 5.1 **应用示例**

**任务**：“修复Bug：在暗黑模式下，导入/导出按钮的文字颜色看不清。”

**AI的响应流程**:

**(阶段一：规划与确认)**

> 好的，收到Bug修复任务。
>
> 这是我的修复计划`TODO.md`。一旦您批准，我将连续完成所有步骤，并在最后请求您的验收。
> ```markdown
> # Bug修复：暗黑模式按钮文字颜色问题
>
> - [ ] 1. **定位问题**: 在 `sidepanel.css` 中找到控制按钮颜色，且未对暗黑模式做适配的CSS规则。
> - [ ] 2. **编写修复代码**: 增加一条CSS规则，利用 `body.dark-theme` 选择器，为暗黑模式下的按钮设置高对比度的文字颜色。
> - [ ] 3. **回归测试准备**: 准备好在明暗两种模式下验证的步骤。
> ```
> 请您批准此计划。

**(您批准后...AI将自动开始执行)**

**(阶段二：完成汇报与请求验收)**

> **任务完成报告**
>
> 本轮 `TODO` 清单中的所有任务均已完成。
>
> **工作总结**:
> 1.  **问题定位**: 成功定位到 `sidepanel.css` 中 `.button` 类的颜色定义未对暗黑模式适配。
> 2.  **代码变更**: 在 `sidepanel.css` 中增加了以下代码：
>     ```css
>     body.dark-theme .button {
>         color: #FFFFFF; /* 或其他高对比度颜色 */
>     }
>     ```
>
> **最终任务状态**:
> ```markdown
> # Bug修复：暗黑模式按钮文字颜色问题
>
> - [x] 1. **定位问题**: 在 `sidepanel.css` 中找到控制按钮颜色，且未对暗黑模式做适配的CSS规则。
> - [x] 2. **编写修复代码**: 增加一条CSS规则，利用 `body.dark-theme` 选择器，为暗黑模式下的按钮设置高对比度的文字颜色。
> - [x] 3. **回归测试准备**: 准备好在明暗两种模式下验证的步骤。
> ```
>
> 所有开发步骤已完成。现请求您对修复结果进行整体测试和验收，并提供您的反馈。




