## 目标与原则
- 全部用户可见文本（页面、弹窗、提示、属性与无障碍）100%国际化，无任何硬编码。
- 保持现有架构稳定：不重构遗留原生JS，仅进行必要的Bug修复与标注；遵循 MV3 与统一数据入口。
- 本地优先、渐进增强：语言切换可靠、离线可用；改动遵循最小影响原则。

## 键命名与分组规范
- 统一分组：
  - `app.*`、`button.*`、`form.*`（`form.title.*`、`form.label.*`、`form.placeholder.*`）、`label.*`
  - `preview.*`、`toast.*`、`error.*`、`confirm.*`
  - `data.*`、`file.*`、`tag.*`、`sync.*`
  - `theme.*`、`language.*`、`settings.*`、`version.*`
- 去重与统一：废弃重复键（如 `author.label` 与 `label.author` 仅保留 `label.author`），提供迁移别名以兼容旧调用。
- 命名规则：简短、语义清晰、可组合（如 `tag.selectedPrefix/suffix` 便于不同语序语言）。

## 架构与资源分层
- 扩展级文案：`_locales/**/messages.json`（例如右键菜单、Manifest 占位）。
- 应用级文案：`assets/i18n/*.json`（界面所有动态文本与属性）。
- 规则：扩展外壳用 `_locales`；业务 UI 与运行态全部使用 `assets/i18n` 与自研 `i18n.js`。

## 引擎与运行时改造
- 强化 `src/utils/i18n.js`：
  - 保留 `data-i18n`（文本）与 `data-i18n-attr`（`placeholder/title/alt/aria-label` 等属性）双通道。
  - 保护结构：`data-i18n` 仅作用于承载文案的子节点，不覆盖 `label` 中的必填星等装饰；在表单处使用子 `span` 承载文案。
  - 初始化兜底最小化：移除散落的硬编码兜底，改为缺键可视化标记（可选：为缺键元素加 `data-i18n-missing`）。
  - 语言/主题选中状态更新保持不变，确保离线可用。

## 全面替换清单（按模块）
- `src/sidepanel/sidepanel.html`
  - 表单：`label` 改为 `* + <span data-i18n>`；输入与文本域改 `data-i18n-attr="placeholder"`。
  - 所有分组标题、按钮 `title/aria-label`、图片 `alt` 改为 `data-i18n-attr`；移除硬编码中文/英文。
  - 主题与语言选项的文案改为字典注入，统一尺寸与间距。
  - 确认弹窗的 `title` 与 `message` 由业务注入，容器默认文本清空。
- `src/sidepanel/uiManager.js`
  - 统一复制成功/失败走 `preview.copied` 与 `toast.copyFail`；移除 `actions.copied` 等不存在键。
  - 标签“全部”不再硬编码对比中文，使用 `this.t('filter.all')`；“更多/收起”tooltip 用 `filter.showMore/collapse`。
  - 所有 `showToast/console` 的用户可见消息改为字典键。
- `src/sidepanel/appController.js`
  - 所有确认弹窗统一 `showCustomConfirm(i18n.t('...'), i18n.t('confirm.title'))`；成功/失败提示统一使用字典键。
- `src/content_script.js`
  - 在构建任何 UI 前确保 `i18n.init()` 完成；所有动态插入的节点使用 `data-i18n`/`data-i18n-attr`。
- `src/sidepanel/components/SmartTagInput.svelte`
  - `aria-label`、“推荐标签”标题、计数提示改用字典键并支持语言语序（前后缀键）。
- `src/utils/json-utils.js`
  - 导出/导入文件名前缀、模板名与失败记录统一 `file.*` 键；所有错误与提示走 `error.*`/`toast.*`。
- `src/utils/data-service.js`
  - 输入校验的错误文案统一国际化；禁止任何用户可见硬编码字符串。
- `src/background.js`
  - 保持 `chrome.i18n.getMessage(...)` 使用 `_locales` 键。
- `src/sidepanel/css/components.css`
  - 清理可能的内容型硬编码（如伪元素 `content`），避免语言相关文本出现在 CSS 中；统一主题/语言选择器尺寸。

## 无障碍与属性国际化
- 全面覆盖 `title`、`alt`、`aria-label`、`placeholder` 等属性型文案，使用 `data-i18n-attr` 注入。
- 为重要交互元素提供可访问说明（复制、删除、同步等）。

## 测试与质量保证
- 单元测试（轻量）：
  - `i18n.t` 的键命中/缺失行为、`applyTranslations` 的文本/属性应用、缺键标记逻辑。
- UI 自测脚本：
  - 打开侧栏 → 验证表单标签与占位、复制成功/失败提示、主题/语言选项文案与选中状态、确认弹窗标题与消息注入。
- 多语言回归：
  - `zh_CN ↔ en` 切换后，检查关键 UI 元素的文本与属性同步更新。

## 持续检查与治理
- 规则化检查：
  - ESLint 自定义规则：禁止在 UI 文件（`.html/.js/.svelte`）中出现直接中文或英文硬编码字符串（允许日志与变量名）。
  - 例外机制：若确有示例数据，要求显式注释并包裹在非用户可见区域。
- 预提交钩子：
  - 运行“硬编码扫描 + 键存在性校验”（比对 `assets/i18n/*.json` 与使用处）并阻止提交。
- CI 检查：
  - 在构建阶段执行同样的扫描与报告，生成国际化覆盖率清单。

## 迁移策略与风险控制
- 渐进迁移：先处理最常用视图（侧边栏与设置），再覆盖内容脚本与工具模块；保留别名键过渡，避免一次性破坏。
- 回滚点：每一批次改动保持可独立发布并可回退；在字典中为旧键保留一个版本以平滑迁移。
- 离线保障：字典加载失败时仅显示键名，不抛错；核心交互不依赖网络。

## 交付物
- 完整字典（`zh_CN.json` 与 `en.json`）与键规范文档。
- 覆盖报告（键使用统计、未覆盖项与风险项清单）。
- 自测脚本与结果截图。
- ESLint 规则与预提交钩子、CI 检查脚本。

## 里程碑
- 第1阶段（审计与规范）：完成键清单与风险点 → 1–2天。
- 第2阶段（侧边栏与设置全面国际化）：HTML/JS/Svelte/CSS 改造与自测 → 2–3天。
- 第3阶段（工具与内容脚本）：`json-utils/data-service/content_script` 文案国际化 → 1–2天。
- 第4阶段（质量治理）：测试、钩子与CI接入、覆盖报告 → 1天。

请确认该计划。如确认，我将按上述里程碑逐步落地实现、提交改动并提供报告与截图。