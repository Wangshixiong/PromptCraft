# 智能标签组件开发 - 新功能规划

## 任务概述
开发一个智能标签输入组件(SmartTagInput)，提供直观的标签选择和管理功能，包括推荐标签、实时过滤、新标签创建等交互能力。

## TODO 清单

### [ ] 需求澄清与用户故事
**用户故事**: 
- As a 用户, I want 在添加/编辑提示词时能够方便地选择和管理标签, so that 我可以更好地组织和分类我的提示词内容。
- As a 用户, I want 看到推荐的已有标签, so that 我可以保持标签的一致性，避免创建重复或相似的标签。
- As a 用户, I want 能够快速输入和创建新标签, so that 我可以灵活地为提示词添加个性化的分类标记。
- As a 用户, I want 在列表中看到提示词的标签和作者信息, so that 我可以快速识别和筛选内容。

**具体需求**:
1. 智能标签组件包含：已选标签区域、输入框、推荐标签栏
2. 支持点击推荐标签添加、输入过滤、回车/逗号创建新标签
3. 支持删除已选标签并重新显示在推荐栏
4. 表单视图集成组件并新增作者输入框
5. 列表视图展示多标签和作者信息（作者显示在标题下方）
6. 顶部筛选按钮动态生成并更新筛选逻辑

### [ ] 技术方案设计
**技术栈选择**:
- 使用 Svelte 框架开发 SmartTagInput 组件
- 使用 Tailwind CSS 进行原子化样式开发
- 遵循现有的数据服务模式，通过 dataService 统一管理数据

**组件架构**:
1. **SmartTagInput.svelte** - 核心智能标签组件
   - Props: initialTags, onTagsChange
   - State: selectedTags, availableTags, inputValue, filteredTags
   - Methods: addTag, removeTag, filterTags, createNewTag

2. **数据服务扩展**:
   - 在 dataService 中添加 getAllTags() 方法
   - 确保标签数据的统一管理和去重

3. **UI集成点**:
   - 表单视图：替换现有分类选择，新增作者输入
   - 列表视图：修改卡片布局展示多标签
   - 筛选栏：动态生成标签筛选按钮

**样式设计**:
- 已选标签：蓝色背景的pill样式，带删除按钮
- 推荐标签：灰色边框的pill样式，hover效果
- 输入框：与现有表单输入框保持一致
- 支持明暗主题切换

### [ ] 详细的开发步骤

#### 步骤1: 数据服务扩展
1. 修改 `src/utils/data-service.js`，添加 `getAllTags()` 方法
2. 实现标签数据的提取、去重和排序逻辑
3. 确保与现有数据结构兼容

#### 步骤2: 创建 SmartTagInput 组件
1. 在 `src/sidepanel/components/` 下创建 `SmartTagInput.svelte`
2. 实现组件的基础结构和样式
3. 添加标签选择、过滤、创建、删除等核心交互逻辑
4. 实现推荐标签栏的动态渲染和交互

#### 步骤3: 集成到表单视图
1. 修改表单相关文件，引入 SmartTagInput 组件
2. 替换现有的分类选择逻辑
3. 新增作者输入框
4. 更新表单数据处理逻辑

#### 步骤4: 更新列表视图
1. 修改提示词卡片的UI布局
2. 实现多标签的优雅展示
3. 在标题下方添加作者信息显示
4. 确保在不同屏幕尺寸下的响应式效果

#### 步骤5: 更新筛选逻辑
1. 修改顶部筛选按钮的生成逻辑
2. 从所有提示词的 tags 数组中动态提取筛选选项
3. 更新筛选功能以支持多标签筛选
4. 保持筛选状态的持久化

#### 步骤6: 测试和优化
1. 测试组件在各种场景下的表现
2. 验证数据一致性和性能
3. 确保与现有功能的兼容性
4. 优化用户体验细节

## 预期成果
1. 一个功能完整的智能标签输入组件
2. 更新的表单视图，支持标签和作者管理
3. 优化的列表视图，更好地展示提示词信息
4. 动态的标签筛选功能
5. 保持与现有功能的完全兼容性

## 风险评估
- **数据兼容性**: 需要确保新的标签系统与现有数据结构兼容
- **性能影响**: 大量标签时的渲染和过滤性能
- **用户体验**: 组件的响应速度和交互流畅性

## 验收标准
1. 智能标签组件功能完整，交互流畅
2. 表单和列表视图成功集成新功能
3. 筛选功能正常工作
4. 所有现有功能保持正常
5. 支持明暗主题
6. 代码质量符合项目规范