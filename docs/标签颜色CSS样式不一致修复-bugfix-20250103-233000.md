# 标签颜色CSS样式不一致修复计划

## 任务分类
`bug_fix` - Bug修复

## TODO 清单

### [ ] 清晰的复现步骤
1. 打开提示词插件侧边栏，观察提示词标签的颜色
2. 在任意网页输入框中按 `pp` 唤醒快速调用窗口
3. 对比两个界面中相同标签的颜色显示
4. **现象**: 同一个标签在两个界面中显示的颜色深浅不一致

### [ ] 根源分析 (Root Cause Analysis)

**用户的分析是完全正确的！** 问题确实出在CSS样式定义的差异上，而非颜色函数不统一。

通过代码对比发现：

**唤醒窗口** (`content_script.js` 第240-250行):
```css
/* 明亮模式 */
.tag.tag-blue { 
    background-color: rgba(59, 130, 246, 0.1); 
    color: #3b82f6; 
    border-color: rgba(59, 130, 246, 0.3);  /* 边框透明度: 0.3 */
}

/* 暗色模式 */
[data-theme="dark"] .tag.tag-blue { 
    background-color: rgba(59, 130, 246, 0.2); 
    color: #60a5fa; 
    border-color: rgba(59, 130, 246, 0.4);  /* 边框透明度: 0.4 */
}
```

**侧边栏** (`sidepanel/css/components.css` 第699-760行):
```css
/* 明亮模式 */
.tag-blue {
    background-color: rgba(59, 130, 246, 0.1);
    color: #3b82f6;
    border: 1px solid rgba(59, 130, 246, 0.2);  /* 边框透明度: 0.2 */
}

/* 暗色模式 */
.dark-mode .tag-blue {
    background-color: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
    border-color: rgba(59, 130, 246, 0.3);  /* 边框透明度: 0.3 */
}
```

**根本原因**: 
- 两个环境使用了相同的颜色函数 (`GlobalTagColorManager`)
- 但CSS样式定义中的**边框透明度不一致**
- 唤醒窗口的边框比侧边栏更深（透明度更高），导致视觉差异

### [ ] 修复方案设计

**目标**: 统一两个环境的标签CSS样式，确保视觉一致性。

**方案**: 修改 `content_script.js` 中的标签CSS样式，使其与侧边栏的样式完全一致。

**具体修改**:
1. 将唤醒窗口明亮模式的边框透明度从 `0.3` 改为 `0.2`
2. 将唤醒窗口暗色模式的边框透明度从 `0.4` 改为 `0.3`
3. 确保所有10种颜色（blue, green, purple, orange, pink, indigo, red, yellow, teal, gray）都保持一致

### [ ] 强制安全检查 (Mandatory Safety Check)

**回归风险评估**: 这个修复方案是否可能违反【最高指令 #1: 绝不引入回归】？

**答案**: **不会引入回归**，原因如下：
1. **纯视觉调整**: 只修改CSS样式的透明度数值，不涉及任何功能逻辑
2. **向标准对齐**: 将唤醒窗口的样式调整为与侧边栏一致，侧边栏是主要界面，应作为标准
3. **最小化改动**: 只修改边框透明度，不触及背景色、文字色等其他属性
4. **无功能影响**: 标签的点击、筛选、显示等功能完全不受影响
5. **改善用户体验**: 修复后将消除用户困惑，提升界面一致性

**结论**: 此方案100%安全，只会改善视觉体验，不会破坏任何现有功能。

### [ ] 详细的修复步骤

1. **定位目标文件**: `src/content_script.js`
2. **修改明亮模式标签样式** (约第241-250行):
   - 将所有 `border-color: rgba(R, G, B, 0.3)` 改为 `rgba(R, G, B, 0.2)`
3. **修改暗色模式标签样式** (约第252-261行):
   - 将所有 `border-color: rgba(R, G, B, 0.4)` 改为 `rgba(R, G, B, 0.3)`
4. **验证修改**: 确保所有10种颜色都已正确修改
5. **测试验证**: 
   - 在明亮模式下对比唤醒窗口和侧边栏的标签颜色
   - 在暗色模式下对比唤醒窗口和侧边栏的标签颜色
   - 确认颜色完全一致

---

**创建时间**: 2025-01-03 23:30:00  
**问题类型**: CSS样式不一致  
**影响范围**: 唤醒窗口标签显示  
**修复复杂度**: 低（纯CSS调整）